<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.16  |
    |              on 2025-06-22 09:38:12              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
 namespace DagaSmart\BizAdmin\Extend; use Illuminate\Support\Arr; use DagaSmart\BizAdmin\Admin; use DagaSmart\BizAdmin\Renderers\Form; use Illuminate\Support\Facades\Route; use Psr\Container\NotFoundExceptionInterface; use DagaSmart\BizAdmin\Support\ComposerProperty; use Psr\Container\ContainerExceptionInterface; use DagaSmart\BizAdmin\Models\Extension as ExtensionModel; use Illuminate\Support\ServiceProvider as LaravelServiceProvider; abstract class ServiceProvider extends LaravelServiceProvider { use CanImportMenu; public $composerProperty; protected $name; protected $code; protected $packageName; protected $path; protected $config; protected $middleware = []; protected $exceptRoutes = []; public function boot() { goto rbRkm; rbRkm: if (!Extension::tableExists()) { goto vEnUM; } goto zgHv6; zgHv6: $this->autoRegister(); goto bDil7; V26Mz: vEnUM: goto Hp866; bDil7: $this->init(); goto V26Mz; Hp866: } public final function init() { goto TLIsJ; NZhvI: $this->addExceptRoutes(); goto PcCnv; P5fOm: if (!$this->middleware()) { goto sX40g; } goto kiDvY; Pfpj0: sX40g: goto UPadm; PcCnv: ZsPO1: goto A259b; kiDvY: $this->addMiddleware(); goto Pfpj0; Ea757: ZNJpr: goto P5fOm; yZlTJ: return; goto b2aoB; A259b: $this->initRoutes(); goto G6Ouq; HSo9M: if (!($kboy4 = $this->getLangPath())) { goto ZNJpr; } goto DuaqD; DuaqD: $this->loadTranslationsFrom($kboy4, $this->getCode()); goto Ea757; TLIsJ: $this->customInitBefore(); goto ORoyc; ORoyc: if (!$this->disabled()) { goto ZkSgl; } goto yZlTJ; G6Ouq: $this->customInitAfter(); goto XfSO1; UPadm: if (!$this->exceptRoutes) { goto ZsPO1; } goto NZhvI; b2aoB: ZkSgl: goto HSo9M; XfSO1: } public function customInitBefore() { } public function customInitAfter() { } public function settingForm() { return null; } public function initRoutes() { goto m4eWH; SN5yN: Afend: goto vAqGu; BMvb0: du6h9: goto n4gd0; vAqGu: if (!($FvltX = $this->getRoutes())) { goto du6h9; } goto mJ5fw; mJ5fw: $this->registerRoutes($FvltX); goto BMvb0; m4eWH: if (!$this->disabled()) { goto Afend; } goto wBtvn; wBtvn: return; goto SN5yN; n4gd0: } protected function autoRegister() { goto UMea5; AxGOS: return; goto D3WYT; D3WYT: J87w1: goto lh2re; lh2re: Admin::extension()->addExtension($this); goto d1Dm8; UMea5: if (!$this->getCode()) { goto J87w1; } goto AxGOS; d1Dm8: } public function getName() { return $this->name ?: ($this->name = $this->getAlias()); } public function getCode() { goto TQPT6; uRpfq: return $this->code; goto EoPPy; TQPT6: if (!(!$this->code && $this->getPackageName())) { goto A6RSJ; } goto rSdOl; Xbkcp: A6RSJ: goto uRpfq; rSdOl: $this->code = str_replace("\57", "\56", $this->getPackageName()); goto Xbkcp; EoPPy: } public function getAlias() { return $this->composerProperty?->alias; } public function getPackageName() { goto m76Lg; wKJJG: K95VI: goto vF3Kd; m76Lg: if ($this->packageName) { goto thjps; } goto A7zc9; A7zc9: if ($this->composerProperty) { goto K95VI; } goto sUrtR; vF3Kd: $this->packageName = $this->composerProperty->name; goto T3V9s; T3V9s: thjps: goto MUErP; MUErP: return $this->packageName; goto gm_Rj; sUrtR: return; goto wKJJG; gm_Rj: } public function getVersion() { goto yZLGR; XEA8M: return "\61\x2e\60\56\60"; goto x5Opb; x5Opb: pz26i: goto sDL8S; sDL8S: return $this->composerProperty->version; goto K13xh; yZLGR: if ($this->composerProperty) { goto pz26i; } goto XEA8M; K13xh: } public function path(?string $ZkOaA = null) { goto mJor6; Qy4Dd: throw new \Exception("\124\x68\x65\x20{$this->path}\x20\x69\163\40\x6e\x6f\x74\40\141\40\144\151\x72\x65\143\164\x6f\162\171\56"); goto Usd1c; gYReo: $this->path = realpath(dirname((new \ReflectionClass(static::class))->getFileName()) . "\57\56\56"); goto j7SjF; mJor6: if ($this->path) { goto mv3fs; } goto gYReo; gPJE3: $ZkOaA = ltrim($ZkOaA, "\57"); goto VSJhr; VSJhr: return $ZkOaA ? $this->path . "\57" . $ZkOaA : $this->path; goto r9FX6; noNqA: mv3fs: goto gPJE3; Usd1c: UjND8: goto noNqA; j7SjF: if (is_dir($this->path)) { goto UjND8; } goto Qy4Dd; r9FX6: } public function getLogoPath() { return $this->path("\x6c\x6f\x67\157\x2e\160\156\x67"); } public function getLogoBase64() { try { goto LUFFK; UL1i_: $tw4mD = chunk_split(base64_encode($OLtQ2)); goto wCibU; ywlJP: $OLtQ2 = fread($o0zdn, filesize($RUpq7)); goto jrNkO; LUFFK: $RUpq7 = $this->getLogoPath(); goto OQExX; OQExX: if (!(is_file($RUpq7) && ($o0zdn = fopen($RUpq7, "\x72\142", 0)))) { goto fZLMY; } goto ywlJP; Yp109: fZLMY: goto fC8X6; jrNkO: fclose($o0zdn); goto UL1i_; wCibU: return "\144\x61\164\x61\x3a\151\x6d\x61\x67\145\x2f\x70\156\147\x3b\142\141\163\x65\x36\64\54" . $tw4mD; goto Yp109; fC8X6: } catch (\ReflectionException $FXDMR) { } return ''; } public function getDocs() { goto i9Ql2; MP1QK: foreach ($lJj6Q as $CdSu7) { goto tX2DH; BgTzX: return file_get_contents($ZkOaA); goto HJ0VJ; tX2DH: $ZkOaA = $this->path($CdSu7); goto Oq3xs; kgm3K: DU5Gq: goto u9zcX; HJ0VJ: UanPi: goto kgm3K; Oq3xs: if (!is_file($ZkOaA)) { goto UanPi; } goto BgTzX; u9zcX: } goto ocQag; ocQag: NT75T: goto nxwPV; i9Ql2: $lJj6Q = ["\162\x65\x61\144\x6d\145\x2e\155\144", "\x52\x45\101\x44\115\x45\56\155\x64"]; goto MP1QK; nxwPV: } public function enabled($QOmn1 = null) { return Admin::extension()->enabled($this->getCode(), $QOmn1); } public function used($QOmn1 = null) { goto rk9xt; RlF5k: $mVOTJ .= sprintf("\55\x25\163", Admin::currentModule(true)); goto VTqq_; i0jCz: $mVOTJ .= sprintf("\x2d\x25\x73", $QOmn1); goto pVwIN; MuuI0: return Admin::extension()->settings()->has($mVOTJ); goto yix1Q; RgTTj: if (is_null(Admin::currentModule(true))) { goto PhZvI; } goto RlF5k; H0E41: if (is_null($QOmn1)) { goto TOmME; } goto i0jCz; pVwIN: TOmME: goto MuuI0; rk9xt: $mVOTJ = $this->getCode(); goto RgTTj; VTqq_: PhZvI: goto H0E41; yix1Q: } public function disabled() { return !$this->enabled(); } public function config(string $ZAY66 = null, $a30rh = null) { goto y325p; S8JN8: return Arr::get($FP1bf, $ZAY66, $a30rh); goto Z8iNe; AKw_i: return $FP1bf; goto CJYc1; y325p: $FP1bf = Admin::setting()->get($this->getConfigKey()); goto qou5d; CJYc1: R9OOC: goto S8JN8; qou5d: if (!is_null($ZAY66)) { goto R9OOC; } goto AKw_i; Z8iNe: } public static function setting($ZAY66 = null, $a30rh = null) { goto t2ui5; YqKoO: return null; goto khS1T; pVhzc: return $IYtBO->config($ZAY66, $a30rh); goto gyIZZ; TyW28: if (!$IYtBO instanceof ServiceProvider) { goto DSJKB; } goto pVhzc; t2ui5: $IYtBO = static::instance(); goto TyW28; gyIZZ: DSJKB: goto YqKoO; khS1T: } public function saveConfig(array $FP1bf) { Admin::setting()->set($this->getConfigKey(), $FP1bf); } protected function initConfig() { $this->config = Admin::setting()->get($this->getConfigKey()); } public function doEnable($lFsKe = true) { goto Y965F; BqzBZ: $this->flushMenu(); goto Xnnt_; Xnnt_: goto c2a83; goto Hf0iZ; Y965F: if ($lFsKe) { goto kcNCb; } goto BqzBZ; iDqg4: c2a83: goto eio5M; XCIhq: $this->refreshMenu(); goto iDqg4; Hf0iZ: kcNCb: goto XCIhq; eio5M: } public function runMigrations(bool $e91Wq = false) { goto Yp1YK; X9iCn: if ($e91Wq) { goto saDBd; } goto o4vbp; N8VYU: gTA5C: goto XgLKv; uuqCW: if ($kiLYC) { goto gTA5C; } goto Zexw_; ERqv9: if (is_dir($ZkOaA)) { goto Ri3Fb; } goto pv0OV; Yp1YK: $ZkOaA = $this->path("\x64\141\164\141\142\x61\x73\145\57\x6d\151\x67\x72\x61\x74\x69\x6f\x6e\x73"); goto ERqv9; pv0OV: return; goto kWTst; ABpx3: goto iL7uG; goto wZ1qe; kWTst: Ri3Fb: goto iIafF; wZ1qe: saDBd: goto uuqCW; o4vbp: app("\155\151\x67\162\x61\164\x6f\162")->run($ZkOaA); goto ABpx3; iIafF: $kiLYC = ExtensionModel::query()->where("\143\157\144\x65", $this->getCode())->exists(); goto X9iCn; XgLKv: iL7uG: goto BzZDo; Zexw_: app("\155\x69\x67\162\141\164\157\x72")->rollback($ZkOaA); goto N8VYU; BzZDo: } public function install() { $this->publishable(); $this->runMigrations(); } public function uninstall() { goto VcJ1x; oyVxX: $this->runMigrations(true); goto R_TUB; ZGdtD: $this->unpublishable(); goto oyVxX; RtfQL: $this->flushMenu(); goto ZGdtD; VcJ1x: if (!ExtensionModel::query()->where("\143\x6f\x64\145", $this->getCode())->where("\155\x6f\x64\x75\x6c\x65", Admin::currentModule(true))->where("\x6d\x65\x72\x5f\x69\144", Admin::merId())->first()->delete()) { goto ssd9c; } goto RtfQL; R_TUB: ssd9c: goto kXxGO; kXxGO: } public function publishable() { goto VAtew; AAbhH: HUU1V: goto bp6AU; DD1vu: jp31L: goto n8q7t; ymE64: if (file_exists($this->getPublishPath())) { goto jp31L; } goto Cn4zp; VAtew: if (!file_exists($this->getAssetPath())) { goto HUU1V; } goto ymE64; n8q7t: app("\x66\151\154\x65\163")->copyDirectory($this->getAssetPath(), $this->getPublishPath()); goto AAbhH; Cn4zp: app("\x66\151\x6c\145\x73")->makeDirectory($this->getPublishPath(), 0755, true, true); goto DD1vu; bp6AU: } public function unpublishable() { goto RWFXV; fOKr1: snuSG: goto iCXM6; adErF: if ($kiLYC) { goto snuSG; } goto Cn1st; Cn1st: app("\x66\151\154\x65\163")->deleteDirectory($this->getPublishPath()); goto fOKr1; RWFXV: $kiLYC = \DagaSmart\BizAdmin\Models\Extension::query()->where("\143\x6f\144\x65", $this->getCode())->exists(); goto adErF; iCXM6: } protected function getPublishPath() { return public_path("\x65\170\164\x65\x6e\163\x69\157\x6e\163\x2f" . $this->getPackageName()); } public final function getAssetPath() { return $this->path("\160\165\142\x6c\151\x63\57\145\170\x74\x65\x6e\163\151\x6f\x6e\163\x2f" . $this->packageName); } public final function getLangPath() { return $this->path("\x6c\x61\x6e\147"); } public function registerRoutes($u6Mac) { Route::group(array_filter(["\x64\x6f\x6d\141\x69\x6e" => Admin::config("\x61\x64\x6d\151\156\x2e\162\x6f\x75\164\x65\56\144\x6f\x6d\x61\x69\x6e"), "\x70\162\145\146\151\170" => Admin::config("\x61\144\x6d\x69\x6e\x2e\x72\x6f\165\x74\145\56\x70\162\x65\x66\x69\170"), "\x6d\151\x64\x64\x6c\x65\x77\x61\x72\145" => Admin::config("\x61\144\155\151\x6e\x2e\162\x6f\x75\x74\145\56\x6d\151\144\144\154\x65\167\x61\162\145")]), $u6Mac); } protected function middleware() { return $this->middleware; } protected function addMiddleware() { $this->mixMiddleware($this->middleware()); } protected function mixMiddleware(array $LNtQl) { Admin::mixMiddlewareGroup($LNtQl); } protected function addExceptRoutes() { goto Yh13y; RAndE: Admin::context()->merge("\x70\145\x72\155\x69\x73\163\x69\157\x6e\x2e\145\x78\x63\145\160\164", (array) $this->exceptRoutes["\x70\145\162\155\151\x73\163\x69\157\156"]); goto O0WcX; O0WcX: X5roV: goto AAy57; p7wyF: AdvHX: goto S3ySZ; NGKq_: Admin::context()->merge("\x61\165\x74\x68\56\x65\x78\x63\145\160\164", (array) $this->exceptRoutes["\x61\165\x74\x68"]); goto p7wyF; Yh13y: if (empty($this->exceptRoutes["\160\x65\162\155\x69\x73\163\x69\x6f\156"])) { goto X5roV; } goto RAndE; AAy57: if (empty($this->exceptRoutes["\141\165\164\x68"])) { goto AdvHX; } goto NGKq_; S3ySZ: } public final function getRoutes() { $ZkOaA = $this->path("\163\x72\143\57\110\164\x74\160\x2f\162\157\x75\x74\145\x73\x2e\160\x68\x70"); return is_file($ZkOaA) ? $ZkOaA : null; } public function withComposerProperty(ComposerProperty $qLRGO) { $this->composerProperty = $qLRGO; return $this; } public static function trans(string $ZAY66, array $mpmwv = [], $PdWf1 = null) { return trans(static::instance()->getCode() . "\72\x3a" . $ZAY66, $mpmwv, $PdWf1); } public static function instance() { return app(static::class); } protected function getConfigKey() { return str_replace("\x2e", "\x3a", $this->getCode()); } protected function baseSettingForm() { return Form::make()->panelClassName("\142\157\162\x64\145\162\x2d\x30")->affixFooter()->title('')->data(["\145\170\164\145\x6e\163\x69\x6f\x6e" => $this->getCode()])->initApi(["\x75\x72\x6c" => admin_url("\144\145\166\137\x74\157\x6f\x6c\163\x2f\x65\170\x74\x65\x6e\x73\151\157\156\163\57\147\x65\x74\137\x63\x6f\156\x66\151\x67"), "\155\x65\x74\x68\x6f\x64" => "\120\117\123\x54", "\144\141\x74\x61" => ["\145\x78\164\145\156\x73\x69\157\156" => $this->getCode()]])->actions([amis("\x73\165\142\x6d\151\164")->label(admin_trans("\141\x64\155\x69\x6e\56\163\141\166\145"))->level("\160\162\x69\x6d\141\162\x79")])->api("\160\157\163\164\x3a" . admin_url("\x64\145\x76\137\x74\x6f\x6f\154\163\57\x65\x78\164\145\156\163\151\x6f\x6e\x73\57\163\x61\x76\x65\137\143\x6f\x6e\x66\151\147")); } public function assetUrl($ZkOaA) { return url("\x65\x78\164\145\156\x73\151\x6f\156\x73\x2f" . $this->packageName . $ZkOaA); } public function loadJs($ZkOaA) { Admin::js($this->assetUrl($ZkOaA)); } public function loadCss($ZkOaA) { Admin::css($this->assetUrl($ZkOaA)); } }
