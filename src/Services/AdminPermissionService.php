<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.16  |
    |              on 2025-06-22 09:38:16              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
 namespace DagaSmart\BizAdmin\Services; use Illuminate\Support\Arr; use DagaSmart\BizAdmin\Admin; use Illuminate\Database\Eloquent\Builder; use DagaSmart\BizAdmin\Models\AdminPermission; class AdminPermissionService extends AdminService { public function __construct() { parent::__construct(); $this->modelName = Admin::adminPermissionModel(); } public function getTree() : array { goto KthYv; KthYv: $yE039 = request("\x6e\x61\x6d\145"); goto cUAuQ; cUAuQ: $Xn12S = request("\163\154\x75\147"); goto w4N8W; w4N8W: $q86RX = $this->query()->when($yE039, fn($uzIV4) => $uzIV4->where("\x6e\141\155\x65", "\x6c\x69\153\x65", "\x25" . $yE039 . "\45"))->when($Xn12S, fn($uzIV4) => $uzIV4->where("\x73\x6c\165\x67", "\x6c\151\153\x65", "\45" . $Xn12S . "\45"))->orderBy("\x63\165\163\164\157\x6d\137\157\162\x64\145\x72")->get()->toArray(); goto ZHuwl; ZHuwl: return array2tree($q86RX); goto ycvuR; ycvuR: } public function parentIsChild($H0Ru3, $twnIL) : bool { goto lruK4; ZqBk5: $IFXNI = $IFXNI->parent; goto gghyB; gS_Y7: Z_BJu: goto ZqBk5; lruK4: $IFXNI = $this->query()->find($twnIL); goto N053s; sJVH0: BMgoa: goto c9V0Z; oiz4d: return true; goto gS_Y7; c9V0Z: return false; goto Um2Nv; Tm9rr: if (!($IFXNI->parent_id == $H0Ru3)) { goto Z_BJu; } goto oiz4d; N053s: mAhMF: goto Tm9rr; gghyB: if ($IFXNI) { goto mAhMF; } goto sJVH0; Um2Nv: } public function getEditData($H0Ru3) { goto Bz9gu; Bz9gu: $FTcqL = parent::getEditData($H0Ru3); goto kxJYC; kxJYC: $FTcqL->load(["\x6d\145\x6e\165\163"]); goto Z7ef8; Z7ef8: return $FTcqL; goto q1hAM; q1hAM: } public function store($J6yf0) : bool { goto Xe7dg; D1qW7: $kX4rm = $this->getTableColumns(); goto DZe7m; Xe7dg: $J6yf0["\x69\x64"] = time() . Admin::merId(); goto QtBJl; DZe7m: $MWice = $this->getModel(); goto TbWCk; xq1kV: $this->checkRepeated($J6yf0); goto D1qW7; QtBJl: $J6yf0["\x69\163\137\x63\x75\163\x74\x6f\x6d\151\172\x65"] = 1; goto xq1kV; TbWCk: return $this->saveData($J6yf0, $kX4rm, $MWice); goto rp2Zk; rp2Zk: } public function update($Asg3e, $J6yf0) : bool { goto HR3V_; fLw5t: return $this->saveData($J6yf0, $kX4rm, $MWice); goto uV6kr; y7yTl: amis_abort_if($this->parentIsChild($Asg3e, $twnIL), admin_trans("\141\x64\x6d\x69\x6e\56\x61\144\155\x69\156\137\160\145\162\155\151\x73\x73\151\157\156\x2e\x70\141\x72\x65\x6e\164\137\x69\x64\x5f\156\157\164\x5f\x61\154\x6c\x6f\167")); goto o_Yy1; o_Yy1: m3dgR: goto x530I; RXVV1: $kX4rm = $this->getTableColumns(); goto db3hJ; x530I: $MWice = $this->query()->whereKey($Asg3e)->first(); goto fLw5t; db3hJ: $twnIL = Arr::get($J6yf0, "\160\141\162\x65\156\164\x5f\x69\x64"); goto M1JLv; HR3V_: $this->checkRepeated($J6yf0, $Asg3e); goto RXVV1; M1JLv: if (!($twnIL != 0)) { goto m3dgR; } goto y7yTl; uV6kr: } public function checkRepeated($J6yf0, $H0Ru3 = 0) { goto yLYzR; ahize: amis_abort_if($uzIV4->clone()->where("\163\x6c\x75\147", $J6yf0["\x73\x6c\x75\x67"])->exists(), admin_trans("\x61\144\155\x69\x6e\56\x61\144\x6d\151\156\x5f\160\x65\162\155\151\163\163\151\157\x6e\x2e\x73\154\x75\x67\137\141\154\x72\x65\141\144\x79\137\145\x78\x69\x73\164\163")); goto Xe_zn; yLYzR: $uzIV4 = $this->query()->when($H0Ru3, fn($uzIV4) => $uzIV4->where("\151\144", "\74\76", $H0Ru3)); goto OeymV; OeymV: amis_abort_if($uzIV4->clone()->where("\156\x61\x6d\x65", $J6yf0["\x6e\141\155\x65"])->exists(), admin_trans("\141\x64\x6d\151\156\x2e\x61\x64\x6d\151\156\137\160\145\x72\155\x69\163\x73\151\x6f\x6e\56\156\x61\x6d\x65\x5f\x61\154\x72\145\x61\x64\x79\137\x65\x78\x69\163\164\163")); goto ahize; Xe_zn: } public function list() : array { return ["\151\x74\x65\x6d\163" => $this->getTree()]; } protected function saveData($J6yf0, array $kX4rm, AdminPermission $MWice) : bool { goto wwPFp; MKCHB: return false; goto dRo68; BDmlh: oqsP0: goto MKCHB; zhQiG: foreach ($J6yf0 as $RpIak => $nJGKm) { goto FZC49; ZPuQl: TXQ6C: goto mBrFq; mBrFq: $MWice->setAttribute($RpIak, $nJGKm); goto c3IDE; c3IDE: JvVN1: goto gvXIp; FZC49: if (in_array($RpIak, $kX4rm)) { goto TXQ6C; } goto OO2qG; OO2qG: goto JvVN1; goto ZPuQl; gvXIp: } goto PI_JK; wwPFp: $wULA6 = Arr::pull($J6yf0, "\155\145\x6e\x75\x73"); goto EIaQL; PI_JK: nwvNk: goto eX8oo; eX8oo: if (!$MWice->save()) { goto oqsP0; } goto JlebO; JlebO: $MWice->menus()->syncWithPivotValues(Arr::has($wULA6, "\x30\x2e\151\144") ? Arr::pluck($wULA6, "\x69\x64") : $wULA6, ["\151\x73\137\x63\x75\x73\164\x6f\x6d\x69\172\145" => $MWice->is_customize]); goto I93UV; I93UV: return true; goto BDmlh; EIaQL: $J6yf0["\160\141\162\x65\156\x74\137\x69\144"] = data_get($J6yf0, "\x70\x61\x72\145\156\x74\x5f\x69\144", 0) ?: 0; goto zhQiG; dRo68: } }
